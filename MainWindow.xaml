<Window x:Class="LogViewer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Multi-Log File Viewer" Height="800" Width="1200"
        WindowStartupLocation="CenterScreen">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="200"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <ToolBar Grid.Row="0" Height="40">
            <Button Name="LoadFilesButton" Content="Load Files" Click="LoadFiles_Click" 
                    Padding="10,5" Margin="5,0"/>
            <Button Name="ClearAllButton" Content="Clear All" Click="ClearAll_Click" 
                    Padding="10,5" Margin="5,0"/>
            <Separator/>
            <Button Name="SettingsButton" Content="Settings" Click="Settings_Click" 
                    Padding="10,5" Margin="5,0"/>
            <Button Name="ExportAllButton" Content="Export All" Click="ExportAll_Click" 
                    Padding="10,5" Margin="5,0"/>
            <Button Name="ExportKeywordsButton" Content="Export Keywords" Click="ExportKeywords_Click" 
                    Padding="10,5" Margin="5,0"/>
            <Separator/>
            <TextBlock Text="Search:" VerticalAlignment="Center" Margin="5,0"/>
            <TextBox Name="SearchTextBox" Width="200" Margin="5,0" 
                     TextChanged="SearchTextBox_TextChanged"/>
            <Separator/>
            <TextBlock Text="Time Filter (Â±sec):" VerticalAlignment="Center" Margin="5,0"/>
            <TextBox Name="TimeFilterTextBox" Width="50" Margin="5,0" Text="30"
                     TextChanged="TimeFilterTextBox_TextChanged"/>
            <Button Name="TimeFilterButton" Content="Apply" Click="TimeFilter_Click" 
                    Padding="5,2" Margin="5,0"/>
            <Button Name="ClearTimeFilterButton" Content="Clear" Click="ClearTimeFilter_Click" 
                    Padding="5,2" Margin="5,0"/>
            <Button Name="ExportTimeFilterButton" Content="Export Time Filter" Click="ExportTimeFilter_Click" 
                    Padding="5,2" Margin="5,0"/>
            <Separator/>
            <CheckBox Name="AutoScrollCheckBox" Content="Auto-scroll" IsChecked="True" 
                      VerticalAlignment="Center" Margin="5,0" Checked="AutoScroll_Changed" Unchecked="AutoScroll_Changed">
                <CheckBox.Style>
                    <Style TargetType="CheckBox">
                        <Style.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="Opacity">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0" Value="1.0"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:1" Value="0.8"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:2" Value="1.0"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="RenderTransform.ScaleX">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0" Value="1.0"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:1" Value="1.1"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:2" Value="1.0"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="RenderTransform.ScaleY">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0" Value="1.0"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:1" Value="1.1"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:2" Value="1.0"/>
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                            </Trigger>
                        </Style.Triggers>
                        <Setter Property="RenderTransform">
                            <Setter.Value>
                                <ScaleTransform/>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </CheckBox.Style>
            </CheckBox>
            <ProgressBar Name="LoadingIndicator" Width="100" Height="20" Margin="10,0" 
                         IsIndeterminate="True" Visibility="Collapsed"/>
        </ToolBar>

        <!-- File List Header -->
        <TextBlock Grid.Row="1" Text="Loaded Files" FontWeight="Bold" FontSize="16" 
                   Margin="10,10,10,5"/>

        <!-- File List -->
        <DataGrid Grid.Row="2" Name="LogFilesDataGrid" Margin="10,0,10,10"
                  AutoGenerateColumns="False" 
                  CanUserAddRows="False" 
                  CanUserDeleteRows="False"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column"
                  RowHeaderWidth="0"
                  SelectionMode="Single">
            <DataGrid.Columns>
                <!-- Color Column -->
                <DataGridTemplateColumn Header="Color" Width="60" CanUserResize="False">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Border Background="{Binding Color}" Width="40" Height="20" 
                                    CornerRadius="3" BorderBrush="Gray" BorderThickness="1"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                
                <!-- File Name Column -->
                <DataGridTextColumn Header="File Name" Binding="{Binding Name}" 
                                    IsReadOnly="True" Width="200"/>
                
                <!-- Alias Column -->
                <DataGridTextColumn Header="Alias" Binding="{Binding Alias}" Width="150"/>
                
                <!-- Line Count Column -->
                <DataGridTextColumn Header="Lines" Binding="{Binding LineCount}" 
                                    IsReadOnly="True" Width="80"/>
                
                <!-- File Size Column -->
                <DataGridTextColumn Header="Size" Binding="{Binding FileSizeFormatted}" 
                                    IsReadOnly="True" Width="80"/>
                
                <!-- Actions Column -->
                <DataGridTemplateColumn Header="Actions" Width="120" CanUserResize="False">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <Button Content="{Binding VisibilityButtonText}" 
                                        Click="ToggleVisibility_Click" 
                                        Margin="2" Padding="5,2" FontSize="10" Width="40"/>
                                <Button Content="Remove" Click="RemoveFile_Click" 
                                        Margin="2" Padding="5,2" FontSize="10" Width="50"
                                        Background="LightCoral"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Log Entries -->
        <ListView Grid.Row="3" Name="LogEntriesListView" Margin="10,0,10,10" 
                  Background="Black" Foreground="LightGreen" 
                  FontFamily="Consolas" FontSize="12">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Grid Margin="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="80"/>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <Border Grid.Column="0" Background="{Binding Color}" 
                                Padding="5,2" Margin="0,0,5,0" CornerRadius="3">
                            <TextBlock Text="{Binding Alias}" FontWeight="Bold" 
                                       FontSize="10" Foreground="Black"/>
                        </Border>
                        
                        <TextBlock Grid.Column="1" Text="{Binding LineNumber}" 
                                   Foreground="Gray" FontSize="10"/>
                        
                        <TextBlock Grid.Column="2" Text="{Binding TimestampString}" 
                                   Foreground="LightBlue" FontSize="10"/>
                        
                        <ContentPresenter Grid.Column="3" Content="{Binding FormattedContent}" 
                                        Margin="0,0,0,0"/>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Status Bar -->
        <StatusBar Grid.Row="4" Height="25">
            <TextBlock Name="StatusBarText" Text="Ready"/>
        </StatusBar>
    </Grid>
</Window>